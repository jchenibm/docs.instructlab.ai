---
title: 在 Linux NVIDIA 上安装
description: 在 Linux NVIDIA 机器上配置 ilab 的步骤说明
logo: images/ilab_dog.png
---

# 在 Linux NVIDIA 上安装 InstructLab

## 快速上手

!!! note
    这些步骤将下载一个预制的 `qna.yaml` 文件，以便您可以进行本地构建。如果您不想这样做，可以跳过 `wget`、`mv` 和 `ilab taxonomy diff` 这些步骤。

```bash
python3.11 -m venv --upgrade-deps venv
source venv/bin/activate
pip cache remove llama_cpp_python
pip install 'instructlab[cuda]' \
   -C cmake.args="-DLLAMA_CUDA=on" \
   -C cmake.args="-DLLAMA_NATIVE=off"
pip install vllm@git+https://github.com/opendatahub-io/vllm@2024.08.01
which ilab
ilab config init
cd ~/.local/share/instructlab
mkdir -p taxonomy/knowledge/astronomy/constellations/Phoenix/
wget https://raw.githubusercontent.com/instructlab/taxonomy/26b3fe21ccbb95adc06fe8ce76c7c18559e8dd05/knowledge/science/astronomy/constellations/phoenix/qna.yaml
mv qna.yaml taxonomy/knowledge/astronomy/constellations/Phoenix/
ilab taxonomy diff
ilab data generate
ilab model train
ilab model convert --model-dir checkpoints/instructlab-granite-7b-lab-mlx-q
ilab model serve --model-path instructlab-granite-7b-lab-trained/instructlab-granite-7b-lab-Q4_K_M.gguf
```

## 安装 `ilab`

本文档中的步骤使用 [Python venv](https://docs.python.org/3/library/venv.html) 作为虚拟环境。但是，如果您在机器上使用其他工具（如 [pyenv](https://github.com/pyenv/pyenv) 或 [Conda Miniforge](https://github.com/conda-forge/miniforge)）来管理 Python 环境，请继续使用该工具。否则，在使用 `venv` 时可能会出现已安装但找不到包的问题。

!!! note
    ⏳ `pip install` 可能需要一些时间，具体取决于您的网络连接。如果安装失败并显示错误 ``unsupported instruction `vpdpbusd'``，请在 `pip install` 命令中添加 `-C cmake.args="-DLLAMA_NATIVE=off"`。

1) 使用 Nvidia CUDA 安装

为了获得最佳的 CUDA 体验，需要安装 vLLM 来部署 Safetensors 格式的模型。

```bash
python3 -m venv --upgrade-deps venv
source venv/bin/activate
pip cache remove llama_cpp_python
pip install 'instructlab[cuda]' \
-C cmake.args="-DLLAMA_CUDA=on" \
-C cmake.args="-DLLAMA_NATIVE=off"
pip install vllm@git+https://github.com/opendatahub-io/vllm@2024.08.01
```

2) 在您的 `venv` 环境中，通过运行 `ilab` 命令验证 `ilab` 是否正确安装。

```shell
ilab
```

*`ilab` 命令的输出示例*

```shell
(venv) $ ilab
Usage: ilab [OPTIONS] COMMAND [ARGS]...

CLI for interacting with InstructLab.

If this is your first time running ilab, it's best to start with `ilab
config init` to create the environment.

Options:
--config PATH  Path to a configuration file.  [default:
                    /Users/kellybrown/.config/instructlab/config.yaml]
-v, --verbose  Enable debug logging (repeat for even more verbosity)
--version      Show the version and exit.
--help         Show this message and exit.

Commands:
config    Command Group for Interacting with the Config of InstructLab.
data      Command Group for Interacting with the Data generated by...
model     Command Group for Interacting with the Models in InstructLab.
system    Command group for all system-related command calls
taxonomy  Command Group for Interacting with the Taxonomy of InstructLab.

Aliases:
chat      model chat
generate  data generate
serve     model serve
train     model train
```

!!! important
    每个 `ilab` 命令都需要在 Python 虚拟环境中运行。您可以通过运行 `source venv/bin/activate` 命令进入 Python 环境。

### 可选：为 `ilab` 命令启用 Tab 补全功能

#### Bash（4.4 或更新版本）

使用以下命令在 `bash` 中启用 Tab 补全：

```sh
eval "$(_ILAB_COMPLETE=bash_source ilab)"
```

要在每次打开新 shell 时自动启用此功能，您可以保存补全脚本并从 `~/.bashrc` 中引用它：

```sh
_ILAB_COMPLETE=bash_source ilab > ~/.ilab-complete.bash
echo ". ~/.ilab-complete.bash" >> ~/.bashrc
```

#### Zsh

使用以下命令在 `zsh` 中启用 Tab 补全：

```sh
eval "$(_ILAB_COMPLETE=zsh_source ilab)"
```

要在每次打开新 shell 时自动启用此功能，您可以保存补全脚本并从 `~/.zshrc` 中引用它：

```sh
_ILAB_COMPLETE=zsh_source ilab > ~/.ilab-complete.zsh
echo ". ~/.ilab-complete.zsh" >> ~/.zshrc
```

#### Fish

使用以下命令在 `fish` 中启用 Tab 补全：

```sh
_ILAB_COMPLETE=fish_source ilab | source
```

要在每次打开新 shell 时自动启用此功能，您可以保存补全脚本并从 `~/.bashrc` 中引用它：

```sh
_ILAB_COMPLETE=fish_source ilab > ~/.config/fish/completions/ilab.fish
```